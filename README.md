# 俄罗斯方块游戏 (Tetris Game)

一个使用 C# 和 Avalonia UI 框架开发的现代化俄罗斯方块游戏，支持跨平台运行。

<img src="./README.assets/image-20250616100646308.png" alt="image-20250616100646308" style="zoom:50%;" /><img src="./README.assets/image-20250616100727736.png" alt="image-20250616100727736" style="zoom:50%;" />

## 🎮 游戏特性

### 核心功能
- **经典俄罗斯方块玩法**：7种不同形状的方块（I、O、T、S、Z、J、L）
- **多难度选择**：简单、中等、困难三个难度级别
- **实时计分系统**：根据消除行数和难度计算得分
- **等级系统**：随着游戏进行自动提升等级和速度
- **排行榜功能**：记录和显示历史最高分

### 音效系统
- **背景音乐**：游戏过程中的循环背景音乐
- **音效反馈**：
  - 鼠标划过按钮音效
  - 方块移动音效
  - 方块旋转音效
  - 方块快速下落音效
  - 消除行音效
  - 游戏结束音效
- **跨平台音频支持**：支持 macOS、Windows 和 Linux

### 用户界面
- **现代化界面**：使用 Avalonia UI 构建的美观界面
- **响应式设计**：适配不同屏幕尺寸
- **实时信息显示**：当前得分、等级、难度、下一个方块预览
- **游戏暂停功能**：支持游戏暂停和继续

## 🛠️ 技术栈

- **框架**：.NET 8.0
- **UI 框架**：Avalonia UI
- **编程语言**：C#
- **音频处理**：跨平台系统音频调用
- **数据存储**：JSON 文件存储排行榜数据

## 📁 项目结构

```
TetrisGame/
├── Controllers/           # 游戏控制器
│   └── GameController.cs  # 主游戏逻辑控制
├── Models/               # 数据模型
│   ├── AudioManager.cs   # 音频管理器
│   ├── GameBoard.cs      # 游戏板逻辑
│   ├── LeaderboardManager.cs # 排行榜管理
│   └── [Block classes]   # 各种方块类型
├── Views/                # 视图界面
│   ├── GameView.axaml    # 游戏界面
│   ├── MenuView.axaml    # 菜单界面
│   └── [View code-behind files]
├── bgm/                  # 音频资源
│   ├── bgm.mp3          # 背景音乐
│   ├── click.mp3        # 点击音效
│   ├── move.mp3         # 移动音效
│   ├── rotate.mp3       # 旋转音效
│   ├── fall.mp3         # 下落音效
│   ├── clear.mp3        # 消除音效
│   └── gameover.mp3     # 游戏结束音效
├── MainWindow.axaml      # 主窗口
├── App.axaml            # 应用程序入口
└── TetrisGame.csproj    # 项目配置文件
```

## 🚀 安装和运行

### 系统要求
- .NET 8.0 SDK 或更高版本
- 支持的操作系统：Windows 10+、macOS 10.15+、Linux（主流发行版）

### 安装步骤

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd TetrisGame
   ```

2. **还原依赖**
   ```bash
   dotnet restore
   ```

3. **编译项目**
   ```bash
   dotnet build
   ```

4. **运行游戏**
   ```bash
   dotnet run
   ```

### 发布版本

创建独立可执行文件：

```bash
# Windows
dotnet publish -c Release -r win-x64 --self-contained

# macOS
dotnet publish -c Release -r osx-x64 --self-contained

# Linux
dotnet publish -c Release -r linux-x64 --self-contained
```

## 🎯 游戏操作

### 键盘控制
- **←/→ 方向键**：左右移动方块
- **↓ 方向键**：加速下落
- **↑ 方向键**：旋转方块
- **空格键**：瞬间下落到底部
- **Enter 键**：
  - 游戏中：暂停/继续
  - 游戏结束：返回主菜单

### 鼠标操作
- **点击难度按钮**：选择游戏难度
- **鼠标悬停**：按钮音效反馈

## 🏆 游戏规则

### 得分系统
- **单行消除**：100 × 难度系数 × 等级
- **多行消除**：额外奖励分数
- **难度系数**：简单(1.0)、中等(1.5)、困难(2.0)

### 等级提升
- 每消除一定行数自动提升等级
- 等级越高，方块下落速度越快
- 更高等级获得更多分数

### 游戏结束
- 当新方块无法放置在游戏区域顶部时游戏结束
- 自动保存最高分到排行榜

## 🔧 开发说明

### 架构设计
- **MVC 模式**：清晰的模型-视图-控制器分离
- **事件驱动**：使用事件处理游戏状态变化
- **模块化设计**：音频、游戏逻辑、UI 分离

### 扩展功能
项目支持以下扩展：
- 添加新的方块类型
- 自定义音效和音乐
- 新的游戏模式
- 网络多人对战
- 自定义主题和皮肤

### 代码质量
- 遵循 C# 编码规范
- 完整的错误处理
- 资源自动管理和清理
- 跨平台兼容性考虑

## 🐛 故障排除

### 常见问题

1. **音频无法播放**
   - 确保系统音频驱动正常
   - 检查音频文件是否存在于 `bgm/` 目录
   - macOS 用户确保已安装 `afplay`

2. **游戏无法启动**
   - 确认 .NET 8.0 运行时已安装
   - 检查项目依赖是否正确还原

3. **排行榜数据丢失**
   - 检查 `leaderboard.json` 文件权限
   - 确保应用有写入当前目录的权限

## 📄 许可证

本项目仅用于学习和教育目的。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！

---

**享受游戏！** 🎮✨